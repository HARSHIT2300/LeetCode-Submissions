My approach is based on union find
TC  = O(N* (4alpha))  almost O(N)
â€‹