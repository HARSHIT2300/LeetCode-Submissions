Quite an interesting and confusing problem
Involves tricky thinking but rather okayish implementation
O(min((N1+N2),K)*log(K-1+N1)).